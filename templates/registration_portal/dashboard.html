{% extends 'registration_portal/base.html' %}

{% block title %}Dashboard - Catzonia POS{% endblock %}

{% block content %}
<div class="pos-container">
    <header class="pos-header">
        <div class="pos-header-content">
            <div class="pos-logo">
                <i class="fas fa-cat"></i> CATZONIA POS
            </div>
            <div class="pos-user-info">
                <div class="pos-branch-badge">
                    <i class="fas fa-building"></i> {{ user.get_branch_display }}
                </div>
                <div class="pos-user-badge">
                    <i class="fas fa-user-circle"></i> {{ user.first_name|default:user.username }}
                </div>
                <a href="{% url 'registration_portal:logout' %}" class="pos-btn pos-btn-sm pos-btn-secondary">
                    <i class="fas fa-sign-out-alt"></i> Logout
                </a>
            </div>
        </div>
    </header>

    <div class="pos-body">
        <!-- Stats -->
        <div class="stats-grid">
            <div class="stat-card">
                <div style="color: #3498DB; font-size: 48px; margin-bottom: 10px;">
                    <i class="fas fa-users"></i>
                </div>
                <div class="stat-card-value">{{ today_customers }}</div>
                <div style="color: #7F8C8D;">Today's Customers</div>
            </div>

            <div class="stat-card" style="border-left-color: #27AE60;">
                <div style="color: #27AE60; font-size: 48px; margin-bottom: 10px;">
                    <i class="fas fa-cat"></i>
                </div>
                <div class="stat-card-value">{{ today_cats }}</div>
                <div style="color: #7F8C8D;">Today's Cats</div>
            </div>

            <div class="stat-card" style="border-left-color: #E67E22;">
                <div style="color: #E67E22; font-size: 48px; margin-bottom: 10px;">
                    <i class="fas fa-clipboard-list"></i>
                </div>
                <div class="stat-card-value">{{ today_requests }}</div>
                <div style="color: #7F8C8D;">Pending Bookings</div>
            </div>

            <div class="stat-card" style="border-left-color: #E74C3C;">
                <div style="color: #E74C3C; font-size: 48px; margin-bottom: 10px;">
                    <i class="fas fa-user-check"></i>
                </div>
                <div class="stat-card-value">{{ session.customers_registered }}</div>
                <div style="color: #7F8C8D;">My Session</div>
            </div>
        </div>

        <!-- Quick Actions -->
        <div class="pos-card">
            <div class="pos-card-header">
                <h2><i class="fas fa-bolt"></i> QUICK ACTIONS</h2>
            </div>
            <div class="pos-card-body">
                <div class="service-grid">
                    <a href="{% url 'registration_portal:customer_search' %}" class="service-tile" style="text-decoration: none;">
                        <div class="service-tile-icon">üîç</div>
                        <div class="service-tile-name">SEARCH CUSTOMER</div>
                    </a>

                    <a href="{% url 'registration_portal:register_customer' %}" class="service-tile" style="text-decoration: none;">
                        <div class="service-tile-icon">‚ûï</div>
                        <div class="service-tile-name">NEW CUSTOMER</div>
                    </a>

                    <a href="{% url 'registration_portal:create_service_request' %}" class="service-tile" style="text-decoration: none;">
                        <div class="service-tile-icon">üìã</div>
                        <div class="service-tile-name">NEW BOOKING</div>
                    </a>

                    <a href="{% url 'registration_portal:dashboard' %}" class="service-tile" style="text-decoration: none;">
                        <div class="service-tile-icon">üìä</div>
                        <div class="service-tile-name">DASHBOARD</div>
                    </a>
                </div>
            </div>
        </div>

        <!-- Recent Activity -->
        <div class="pos-card">
            <div class="pos-card-header">
                <h2><i class="fas fa-history"></i> TODAY'S ACTIVITY</h2>
            </div>
            <div class="pos-card-body">
                <div class="row">
                    <div class="col-md-6">
                        <h4><i class="fas fa-users"></i> Recent Customers</h4>
                        {% if recent_customers %}
                            {% for customer in recent_customers %}
                            <div class="cart-item mb-2">
                                <div style="flex: 1;">
                                    <div style="font-weight: 600;">{{ customer.name }}</div>
                                    <small style="color: #7F8C8D;">
                                        <i class="fas fa-phone"></i> {{ customer.phone }}
                                    </small>
                                </div>
                                <small style="color: #7F8C8D;">
                                    {{ customer.created_at|date:"h:i A" }}
                                </small>
                            </div>
                            {% endfor %}
                        {% else %}
                            <p style="color: #7F8C8D;">No customers yet</p>
                        {% endif %}
                    </div>

                    <div class="col-md-6">
                        <h4><i class="fas fa-clipboard-check"></i> Recent Bookings</h4>
                        {% if recent_requests %}
                            {% for package in recent_requests %}
                            <div class="cart-item mb-2">
                                <div style="flex: 1;">
                                    <div style="font-weight: 600;">{{ package.package_id }}</div>
                                    <small style="color: #7F8C8D;">
                                        <i class="fas fa-cat"></i> {{ package.cat.name }} | 
                                        {{ package.total_points }} pts
                                    </small>
                                </div>
                                <small style="color: #7F8C8D;">
                                    {{ package.created_at|date:"h:i A" }}
                                </small>
                            </div>
                            {% endfor %}
                        {% else %}
                            <p style="color: #7F8C8D;">No bookings yet</p>
                        {% endif %}
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}